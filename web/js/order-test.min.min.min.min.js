var order={length:$(".tab-item").length,width:window.screen.width<640?window.screen.width:640+"px",buildElement:function(h,g,l){var f=document.createElement(h);if(typeof(g)=="string"){l=g;g=null}if(g!==undefined){for(var k in g){f.setAttribute(k,g[k])}}if(l!==undefined){f.innerHTML=l}return f},clickfun:function(){$(".tab-header").on("click",".tab-elm",function(f){var d=f.target;var e=$(d).index();$(d).addClass("tab-elm-active").siblings("[class~='tab-elm-active']").removeClass("tab-elm-active");$(".tab-content").css("left",-e*parseFloat(this.width)+"px");this.getlist(e);$(".tab-content")[0].scrollIntoView()}.bind(this))},move:function(f,g){var l=0;var h=0;var k=0;$(".tab-content").on("touchstart",".tab-item",function(){k=event.changedTouches[0].clientX;h=0});$(".tab-content").on("touchmove",".tab-item",function(){var a=event.changedTouches[0].clientX;h=a-k});$(".tab-content").on("touchend",".tab-item",function(a){var b=a.currentTarget;l=$(b).index();if(h>100){if(l>0){l--;this.getlist(l);$(".tab-content")[0].scrollIntoView()}}else{if(h<-100){if(l<(this.length-1)){l++;this.getlist(l);$(".tab-content")[0].scrollIntoView()}}}$($(".tab-header .tab-elm")[l]).addClass("tab-elm-active").siblings("[class~='tab-elm-active']").removeClass("tab-elm-active");$(".tab-content").css("left",-l*g)}.bind(this))},getlist:function(b){$.ajax({type:"GET",url:"http://xiongkun.top/data/order-test.php",data:{state:b},dataType:"json",success:function(z){if(z.length>0){for(var B=0,J=[];B<z.length;B++){var a=[];for(var x=0;x<z.length;x++){if(z[B].ordernum===z[x].ordernum){if(B<=x){a.push(z[x])}else{break}}}if(a.length>0){J.push(a)}}this.arrsort(J);console.log(J);$(".tab-item")[b].innerHTML="";var I=document.createDocumentFragment();var A=this.buildElement("ul",{"class":"cart-elms"});for(var y=0;y<J.length;y++){var H=this.buildElement("li",{"class":"cart-elm cart-goods"});A.appendChild(H);var E=this.buildElement("div",{"class":"cart-elm-top"},'<i class="icon-shop vertical_center"></i>\n<div class="shop-name fl">好万家自营</div>\n<div class="shop-product-status fl">'+$(".tab-elm")[J[y][0].state].innerHTML+"</div>");H.appendChild(E);var F=this.buildElement("div",{"class":"cart-elm-content"});H.appendChild(F);var G=this.buildElement("ul",{"class":"cart-products"});H.appendChild(G);for(var h=0;h<J[y].length;h++){var D=this.buildElement("li",{"class":"cart-product"},'<div class="cart-product-content">\n <div class="cart-product-detail">\n     <div class="cart-product-images vertical_center">\n         <images src='+J[y][h].imgurl+' alt="">\n     </div>\n     <div class="cart-product-text">\n         <p class="cart-product-name">'+J[y][h].name+'</p> <span class="fr">×'+J[y][h].count+'</span>\n         <p class="cart-product-guige cart-guige">规格: '+J[y][h].guige+'</p>\n         <p class="cart-product-price">￥'+J[y][h].price+"</p>\n     </div>\n </div>\n </div>");G.appendChild(D)}var C=this.buildElement("div",{"class":"cart-product-footer"},'<div class="cart-product-footer-left">共<span class="cart-product-footer-num">'+J[y].length+'</span>件商品</div>\n <div class="cart-product-footer-right">\n     实付款：<span class="cart-product-footer-price">￥25111.0</span>\n </div>');H.appendChild(C);var m=this.buildElement("div",{"class":"cart-btn"},' <button class="right-btn">支付</button>\n<button class="left-btn">取消</button>');H.appendChild(m)}I.appendChild(A);$(".tab-item")[b].appendChild(I);var l=getComputedStyle($(".tab-item")[b]).height;console.log(l);$(".tab-content").css("height",l)}else{console.log("null")}}.bind(this)})},arrsort:function(d){for(let i=0;i<d.length;i++){for(let j=0;j<d.length-1;j++){if(d[j][0].ordernum<d[j+1][0].ordernum){var c=d[j];d[j]=d[j+1];d[j+1]=c}}}return d},init:function(){$(".tab-content .tab-item").css("width",this.width);$(".tab-content").css("width",this.length*parseFloat(this.width)+"px");this.clickfun();this.move(this.length,this.width);this.getlist(0)}};window.onload=function(){order.init()};window.onresize=function(){order.init()};