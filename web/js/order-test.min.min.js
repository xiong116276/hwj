var order={length:$(".tab-item").length,width:window.screen.width<640?window.screen.width:640+"px",buildElement:function(f,l,h){var k=document.createElement(f);if(typeof(l)=="string"){h=l;l=null}if(l!==undefined){for(var g in l){k.setAttribute(g,l[g])}}if(h!==undefined){k.innerHTML=h}return k},clickfun:function(){$(".tab-header").on("click",".tab-elm",function(d){var e=d.target;var f=$(e).index();$(e).addClass("tab-elm-active").siblings("[class~='tab-elm-active']").removeClass("tab-elm-active");$(".tab-content").css("left",-f*parseFloat(this.width)+"px");this.getlist(f);$(".tab-content")[0].scrollIntoView()}.bind(this))},move:function(k,l){var h=0;var f=0;var g=0;$(".tab-content").on("touchstart",".tab-item",function(){g=event.changedTouches[0].clientX;f=0});$(".tab-content").on("touchmove",".tab-item",function(){var a=event.changedTouches[0].clientX;f=a-g});$(".tab-content").on("touchend",".tab-item",function(a){var b=a.currentTarget;h=$(b).index();if(f>100){if(h>0){h--;this.getlist(h);$(".tab-content")[0].scrollIntoView()}}else{if(f<-100){if(h<(this.length-1)){h++;this.getlist(h);$(".tab-content")[0].scrollIntoView()}}}$($(".tab-header .tab-elm")[h]).addClass("tab-elm-active").siblings("[class~='tab-elm-active']").removeClass("tab-elm-active");$(".tab-content").css("left",-h*l)}.bind(this))},getlist:function(b){$.ajax({type:"GET",url:"http://xiongkun.top/data/order-test.php",data:{state:b},dataType:"json",success:function(l){if(l.length>0){for(var A=0,I=[];A<l.length;A++){var J=[];for(var z=0;z<l.length;z++){if(l[A].ordernum===l[z].ordernum){if(A<=z){J.push(l[z])}else{break}}}if(J.length>0){I.push(J)}}this.arrsort(I);console.log(I);$(".tab-item")[b].innerHTML="";var H=document.createDocumentFragment();var m=this.buildElement("ul",{"class":"cart-elms"});for(var h=0;h<I.length;h++){var G=this.buildElement("li",{"class":"cart-elm cart-goods"});m.appendChild(G);var D=this.buildElement("div",{"class":"cart-elm-top"},'<i class="icon-shop vertical_center"></i>\n<div class="shop-name fl">好万家自营</div>\n<div class="shop-product-status fl">'+$(".tab-elm")[I[h][0].state].innerHTML+"</div>");G.appendChild(D);var E=this.buildElement("div",{"class":"cart-elm-content"});G.appendChild(E);var F=this.buildElement("ul",{"class":"cart-products"});G.appendChild(F);for(var x=0;x<I[h].length;x++){var C=this.buildElement("li",{"class":"cart-product"},'<div class="cart-product-content">\n <div class="cart-product-detail">\n     <div class="cart-product-img vertical_center">\n         <img src='+I[h][x].imgurl+' alt="">\n     </div>\n     <div class="cart-product-text">\n         <p class="cart-product-name">'+I[h][x].name+'</p> <span class="fr">×'+I[h][x].count+'</span>\n         <p class="cart-product-guige cart-guige">规格: '+I[h][x].guige+'</p>\n         <p class="cart-product-price">￥'+I[h][x].price+"</p>\n     </div>\n </div>\n </div>");F.appendChild(C)}var B=this.buildElement("div",{"class":"cart-product-footer"},'<div class="cart-product-footer-left">共<span class="cart-product-footer-num">'+I[h].length+'</span>件商品</div>\n <div class="cart-product-footer-right">\n     实付款：<span class="cart-product-footer-price">￥25111.0</span>\n </div>');G.appendChild(B);var y=this.buildElement("div",{"class":"cart-btn"},' <button class="right-btn">支付</button>\n<button class="left-btn">取消</button>');G.appendChild(y)}H.appendChild(m);$(".tab-item")[b].appendChild(H);var a=getComputedStyle($(".tab-item")[b]).height;console.log(a);$(".tab-content").css("height",a)}else{console.log("null")}}.bind(this)})},arrsort:function(d){for(let i=0;i<d.length;i++){for(let j=0;j<d.length-1;j++){if(d[j][0].ordernum<d[j+1][0].ordernum){var c=d[j];d[j]=d[j+1];d[j+1]=c}}}return d},init:function(){$(".tab-content .tab-item").css("width",this.width);$(".tab-content").css("width",this.length*parseFloat(this.width)+"px");this.clickfun();this.move(this.length,this.width);this.getlist(0)}};window.onload=function(){order.init()};window.onresize=function(){order.init()};