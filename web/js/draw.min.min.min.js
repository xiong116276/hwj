window.onload=function(){draw.init()};window.onresize=function(){draw.init()};var draw={w:0,h:0,Lamp:0,news:[],duration:3600,init:function(){this.setPin();this.btnArea();this.drawClick();this.drawNews()},imgSize:function(a){this.w=parseFloat(getComputedStyle(a).width);this.h=parseFloat(getComputedStyle(a).height)},setMap:function(k,p,q,o,j,h,g,s,r){$(k).removeClass("hide");$(".icon-close").on("click",function(){$(k).addClass("hide")});this.imgSize($(p)[0]);var n=o/s*this.w,m=h/s*this.w;var l=j/r*this.h,i=g/r*this.h;$($("[name='"+q+"'] area")[0]).attr("coords",n+","+l+","+m+","+i)},setPin:function(){var a=parseFloat(getComputedStyle($(".pin img")[0]).width);$(".pin").css("height",a)},btnArea:function(){this.imgSize($(".draw-bg")[0]);var b=28/750*this.w,a=170/750*this.w,f=576/750*this.w,e=717/750*this.w;var d=364/1227*this.h,c=417/1227*this.h;$($("[name='btn'] area")[0]).attr("coords",b+","+d+","+a+","+c);$($("[name='btn'] area")[1]).attr("coords",f+","+d+","+e+","+c);$($("[name='btn'] area")[0]).on("click",this.ruleShow.bind(this));$($("[name='btn'] area")[1]).on("click",function(){window.location.href="draw-data.html"})},ruleShow:function(){this.setMap(".draw-rule",".rule-bg","btnRule",53,720,550,785,603,815);$($("[name='btnRule'] area")[0]).on("click",function(){$(".draw-rule").addClass("hide")})},drawNothing:function(){this.setMap(".draw-nothing",".draw-nothing-bg","btnDraw",54,641,550,706,604,762);$($("[name='btnDraw'] area")[0]).on("click",function(){$(".draw-nothing").addClass("hide")});this.drawClick()},drawSomething:function(){this.setMap(".draw-something",".draw-something-bg","btnCheck",54,443,550,508,604,544);$($("[name='btnCheck'] area")[0]).on("click",function(){window.location.href="draw-data.html"});this.drawClick()},drawClick:function(){$(".pin").on("click",function(){this.panRoll(0)}.bind(this))},panRoll:function(c){$(".pin").off("click");var b=0;if(Math.random()<0.6){if(Math.random()<0.2){this.duration=3700}else{if(Math.random()<0.4&&Math.random()>=0.2){this.duration=4050}else{if(Math.random()<0.6&&Math.random()>=0.4){this.duration=4500}}}}else{if(Math.random()<0.7&&Math.random()>=0.6){this.duration=3900}else{if(Math.random()<0.8&&Math.random()>=0.7){this.duration=4200}else{if(Math.random()<0.9&&Math.random()>=0.8){this.duration=4650}else{if(Math.random()<1&&Math.random()>=0.8){this.duration=3600}}}}}console.log(this.duration);var a=setInterval(function(){this.panLamp();c+=15;$(".draw-pan").css("transform","rotate("+c+"deg)");b+=50;if(b>=this.duration){clearInterval(a);c=c%360;if(c>=337.5||c<22.5){c=360;this.drawSomething();$(".draw-something-text span").html("25积分")}else{if(c>=22.5&&c<67.5){c=45;this.drawNothing()}else{if(c>=67.5&&c<112.5){c=90;this.drawSomething();$(".draw-something-text span").html("精美礼品")}else{if(c>=112.5&&c<157.5){c=135;this.drawNothing()}else{if(c>=157.5&&c<202.5){c=180;this.drawSomething();$(".draw-something-text span").html("1000积分")}else{if(c>=202.5&&c<247.5){c=270;this.drawNothing()}else{if(c>=247.5&&c<292.5){c=270;this.drawNothing()}else{if(c>=292.5&&c<337.5){c=315;this.drawSomething();$(".draw-something-text span").html("优惠券")}}}}}}}}$(".draw-pan").css("transform","rotate("+c+"deg)")}}.bind(this),50)},panLamp:function(){if(this.Lamp===0){$(".pan-lamp").attr("src","images/draw/red-pan-02.png");this.Lamp=1}else{if(this.Lamp===1){$(".pan-lamp").attr("src","images/draw/red-pan-01.png");this.Lamp=0}}},drawNews:function(){this.imgSize($(".draw-bg")[0]);$(".draw-news").css("height",this.h*(95/1334));this.news=["limm1235 抽中 精美礼品 1分钟前","xiaoxiong 抽中 25积分 2分钟前","weidong 抽中 1000积分 3分钟前","chiyuan 抽中 再接再厉 4分钟前","hongteng 抽中 优惠券 5分钟前"];this.newsRender();this.newsRoll()},newsRender:function(){var a=document.createDocumentFragment();for(var b=0;b<this.news.length;b++){var c=document.createElement("div");c.setAttribute("class","draw-news-item");c.innerHTML=this.news[b];$(c).css({height:$(".draw-news").css("height"),"line-height":$(".draw-news").css("height")});a.appendChild(c)}$(".draw-news-items").append(a)},newsRoll:function(){var a=0;var b=setInterval(function(){a+=1;$(".draw-news-box").css("top",-a+"px");if(a>=parseFloat($(".draw-news").css("height"))){a=0;$(".draw-news-box").css("top",0);$(".draw-news-items").html("");this.news=this.news.slice(1).concat(this.news.slice(0,1));this.newsRender()}}.bind(this),80)}};