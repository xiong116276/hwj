var order={length:$(".tab-item").length,width:window.screen.width<640?window.screen.width:640+"px",buildElement:function(b,c,e){var d=document.createElement(b);if(typeof(c)=="string"){e=c;c=null}if(c!==undefined){for(var a in c){d.setAttribute(a,c[a])}}if(e!==undefined){d.innerHTML=e}return d},clickfun:function(){$(".tab-header").on("click",".tab-elm",function(b){var a=b.target;var c=$(a).index();$(a).addClass("tab-elm-active").siblings("[class~='tab-elm-active']").removeClass("tab-elm-active");$(".tab-content").css("left",-c*parseFloat(this.width)+"px");this.getlist(c);$(".tab-content")[0].scrollIntoView()}.bind(this))},move:function(d,c){var e=0;var b=0;var a=0;$(".tab-content").on("touchstart",".tab-item",function(){a=event.changedTouches[0].clientX;b=0});$(".tab-content").on("touchmove",".tab-item",function(){var f=event.changedTouches[0].clientX;b=f-a});$(".tab-content").on("touchend",".tab-item",function(g){var f=g.currentTarget;e=$(f).index();if(b>100){if(e>0){e--;this.getlist(e);$(".tab-content")[0].scrollIntoView()}}else{if(b<-100){if(e<(this.length-1)){e++;this.getlist(e);$(".tab-content")[0].scrollIntoView()}}}$($(".tab-header .tab-elm")[e]).addClass("tab-elm-active").siblings("[class~='tab-elm-active']").removeClass("tab-elm-active");$(".tab-content").css("left",-e*c)}.bind(this))},getlist:function(a){$.ajax({type:"GET",url:"http://xiongkun.top/data/order-test.php",data:{state:a},dataType:"json",success:function(p){if(p.length>0){for(var f=0,t=[];f<p.length;f++){var s=[];for(var g=0;g<p.length;g++){if(p[f].ordernum===p[g].ordernum){if(f<=g){s.push(p[g])}else{break}}}if(s.length>0){t.push(s)}}this.arrsort(t);console.log(t);$(".tab-item")[a].innerHTML="";var u=document.createDocumentFragment();var o=this.buildElement("ul",{"class":"cart-elms"});for(var q=0;q<t.length;q++){var v=this.buildElement("li",{"class":"cart-elm cart-goods"});o.appendChild(v);var c=this.buildElement("div",{"class":"cart-elm-top"},'<i class="icon-shop vertical_center"></i>\n<div class="shop-name fl">好万家自营</div>\n<div class="shop-product-status fl">'+$(".tab-elm")[t[q][0].state].innerHTML+"</div>");v.appendChild(c);var b=this.buildElement("div",{"class":"cart-elm-content"});v.appendChild(b);var w=this.buildElement("ul",{"class":"cart-products"});v.appendChild(w);for(var n=0;n<t[q].length;n++){var d=this.buildElement("li",{"class":"cart-product"},'<div class="cart-product-content">\n <div class="cart-product-detail">\n     <div class="cart-product-img vertical_center">\n         <img src='+t[q][n].imgurl+' alt="">\n     </div>\n     <div class="cart-product-text">\n         <p class="cart-product-name">'+t[q][n].name+'</p> <span class="fr">×'+t[q][n].count+'</span>\n         <p class="cart-product-guige cart-guige">规格: '+t[q][n].guige+'</p>\n         <p class="cart-product-price">￥'+t[q][n].price+"</p>\n     </div>\n </div>\n </div>");w.appendChild(d)}var e=this.buildElement("div",{"class":"cart-product-footer"},'<div class="cart-product-footer-left">共<span class="cart-product-footer-num">'+t[q].length+'</span>件商品</div>\n <div class="cart-product-footer-right">\n     实付款：<span class="cart-product-footer-price">￥25111.0</span>\n </div>');v.appendChild(e);var k=this.buildElement("div",{"class":"cart-btn"},' <button class="right-btn">支付</button>\n<button class="left-btn">取消</button>');v.appendChild(k)}u.appendChild(o);$(".tab-item")[a].appendChild(u);var r=getComputedStyle($(".tab-item")[a]).height;console.log(r);$(".tab-content").css("height",r)}else{console.log("null")}}.bind(this)})},arrsort:function(a){for(let i=0;i<a.length;i++){for(let j=0;j<a.length-1;j++){if(a[j][0].ordernum<a[j+1][0].ordernum){var b=a[j];a[j]=a[j+1];a[j+1]=b}}}return a},init:function(){$(".tab-content .tab-item").css("width",this.width);$(".tab-content").css("width",this.length*parseFloat(this.width)+"px");this.clickfun();this.move(this.length,this.width);this.getlist(0)}};window.onload=function(){order.init()};window.onresize=function(){order.init()};