window.onload=function(){draw.init()};window.onresize=function(){draw.init()};var draw={w:0,h:0,Lamp:0,news:[],duration:3600,init:function(){this.setPin();this.btnArea();this.drawClick();this.drawNews()},imgSize:function(b){this.w=parseFloat(getComputedStyle(b).width);this.h=parseFloat(getComputedStyle(b).height)},setMap:function(z,w,v,a,c,e,f,t,u){$(z).removeClass("hide");$(".icon-close").on("click",function(){$(z).addClass("hide")});this.imgSize($(w)[0]);var x=a/t*this.w,y=e/t*this.w;var b=c/u*this.h,d=f/u*this.h;$($("[name='"+v+"'] area")[0]).attr("coords",x+","+b+","+y+","+d)},setPin:function(){var b=parseFloat(getComputedStyle($(".pin img")[0]).width);$(".pin").css("height",b)},btnArea:function(){this.imgSize($(".draw-bg")[0]);var k=28/750*this.w,l=170/750*this.w,g=576/750*this.w,h=717/750*this.w;var i=364/1227*this.h,j=417/1227*this.h;$($("[name='btn'] area")[0]).attr("coords",k+","+i+","+l+","+j);$($("[name='btn'] area")[1]).attr("coords",g+","+i+","+h+","+j);$($("[name='btn'] area")[0]).on("click",this.ruleShow.bind(this));$($("[name='btn'] area")[1]).on("click",function(){window.location.href="draw-data.html"})},ruleShow:function(){this.setMap(".draw-rule",".rule-bg","btnRule",53,720,550,785,603,815);$($("[name='btnRule'] area")[0]).on("click",function(){$(".draw-rule").addClass("hide")})},drawNothing:function(){this.setMap(".draw-nothing",".draw-nothing-bg","btnDraw",54,641,550,706,604,762);$($("[name='btnDraw'] area")[0]).on("click",function(){$(".draw-nothing").addClass("hide")});this.drawClick()},drawSomething:function(){this.setMap(".draw-something",".draw-something-bg","btnCheck",54,443,550,508,604,544);$($("[name='btnCheck'] area")[0]).on("click",function(){window.location.href="draw-data.html"});this.drawClick()},drawClick:function(){$(".pin").on("click",function(){this.panRoll(0)}.bind(this))},panRoll:function(d){$(".pin").off("click");var e=0;if(Math.random()<0.6){if(Math.random()<0.2){this.duration=3700}else{if(Math.random()<0.4&&Math.random()>=0.2){this.duration=4050}else{if(Math.random()<0.6&&Math.random()>=0.4){this.duration=4500}}}}else{if(Math.random()<0.7&&Math.random()>=0.6){this.duration=3900}else{if(Math.random()<0.8&&Math.random()>=0.7){this.duration=4200}else{if(Math.random()<0.9&&Math.random()>=0.8){this.duration=4650}else{if(Math.random()<1&&Math.random()>=0.8){this.duration=3600}}}}}console.log(this.duration);var f=setInterval(function(){this.panLamp();d+=15;$(".draw-pan").css("transform","rotate("+d+"deg)");e+=50;if(e>=this.duration){clearInterval(f);d=d%360;if(d>=337.5||d<22.5){d=360;this.drawSomething();$(".draw-something-text span").html("25积分")}else{if(d>=22.5&&d<67.5){d=45;this.drawNothing()}else{if(d>=67.5&&d<112.5){d=90;this.drawSomething();$(".draw-something-text span").html("精美礼品")}else{if(d>=112.5&&d<157.5){d=135;this.drawNothing()}else{if(d>=157.5&&d<202.5){d=180;this.drawSomething();$(".draw-something-text span").html("1000积分")}else{if(d>=202.5&&d<247.5){d=270;this.drawNothing()}else{if(d>=247.5&&d<292.5){d=270;this.drawNothing()}else{if(d>=292.5&&d<337.5){d=315;this.drawSomething();$(".draw-something-text span").html("优惠券")}}}}}}}}$(".draw-pan").css("transform","rotate("+d+"deg)")}}.bind(this),50)},panLamp:function(){if(this.Lamp===0){$(".pan-lamp").attr("src","images/draw/red-pan-02.png");this.Lamp=1}else{if(this.Lamp===1){$(".pan-lamp").attr("src","images/draw/red-pan-01.png");this.Lamp=0}}},drawNews:function(){this.imgSize($(".draw-bg")[0]);$(".draw-news").css("height",this.h*(95/1334));this.news=["limm1235 抽中 精美礼品 1分钟前","xiaoxiong 抽中 25积分 2分钟前","weidong 抽中 1000积分 3分钟前","chiyuan 抽中 再接再厉 4分钟前","hongteng 抽中 优惠券 5分钟前"];this.newsRender();this.newsRoll()},newsRender:function(){var f=document.createDocumentFragment();for(var e=0;e<this.news.length;e++){var d=document.createElement("div");d.setAttribute("class","draw-news-item");d.innerHTML=this.news[e];$(d).css({height:$(".draw-news").css("height"),"line-height":$(".draw-news").css("height")});f.appendChild(d)}$(".draw-news-items").append(f)},newsRoll:function(){var d=0;var c=setInterval(function(){d+=1;$(".draw-news-box").css("top",-d+"px");if(d>=parseFloat($(".draw-news").css("height"))){d=0;$(".draw-news-box").css("top",0);$(".draw-news-items").html("");this.news=this.news.slice(1).concat(this.news.slice(0,1));this.newsRender()}}.bind(this),80)}};