var order={length:$(".tab-item").length,width:window.screen.width<640?window.screen.width:640+"px",buildElement:function(e,a,c){var b=document.createElement(e);if(typeof(a)=="string"){c=a;a=null}if(a!==undefined){for(var d in a){b.setAttribute(d,a[d])}}if(c!==undefined){b.innerHTML=c}return b},clickfun:function(){$(".tab-header").on("click",".tab-elm",function(c){var b=c.target;var a=$(b).index();$(b).addClass("tab-elm-active").siblings("[class~='tab-elm-active']").removeClass("tab-elm-active");$(".tab-content").css("left",-a*parseFloat(this.width)+"px");this.getlist(a);$(".tab-content")[0].scrollIntoView()}.bind(this))},move:function(b,a){var c=0;var e=0;var d=0;$(".tab-content").on("touchstart",".tab-item",function(){d=event.changedTouches[0].clientX;e=0});$(".tab-content").on("touchmove",".tab-item",function(){var f=event.changedTouches[0].clientX;e=f-d});$(".tab-content").on("touchend",".tab-item",function(g){var f=g.currentTarget;c=$(f).index();if(e>100){if(c>0){c--;this.getlist(c);$(".tab-content")[0].scrollIntoView()}}else{if(e<-100){if(c<(this.length-1)){c++;this.getlist(c);$(".tab-content")[0].scrollIntoView()}}}$($(".tab-header .tab-elm")[c]).addClass("tab-elm-active").siblings("[class~='tab-elm-active']").removeClass("tab-elm-active");$(".tab-content").css("left",-c*a)}.bind(this))},getlist:function(a){$.ajax({type:"GET",url:"http://xiongkun.top/data/order-test.php",data:{state:a},dataType:"json",success:function(g){if(g.length>0){for(var e=0,s=[];e<g.length;e++){var r=[];for(var n=0;n<g.length;n++){if(g[e].ordernum===g[n].ordernum){if(e<=n){r.push(g[n])}else{break}}}if(r.length>0){s.push(r)}}this.arrsort(s);console.log(s);$(".tab-item")[a].innerHTML="";var t=document.createDocumentFragment();var f=this.buildElement("ul",{"class":"cart-elms"});for(var k=0;k<s.length;k++){var u=this.buildElement("li",{"class":"cart-elm cart-goods"});f.appendChild(u);var b=this.buildElement("div",{"class":"cart-elm-top"},'<i class="icon-shop vertical_center"></i>\n<div class="shop-name fl">好万家自营</div>\n<div class="shop-product-status fl">'+$(".tab-elm")[s[k][0].state].innerHTML+"</div>");u.appendChild(b);var w=this.buildElement("div",{"class":"cart-elm-content"});u.appendChild(w);var v=this.buildElement("ul",{"class":"cart-products"});u.appendChild(v);for(var q=0;q<s[k].length;q++){var c=this.buildElement("li",{"class":"cart-product"},'<div class="cart-product-content">\n <div class="cart-product-detail">\n     <div class="cart-product-images vertical_center">\n         <images src='+s[k][q].imgurl+' alt="">\n     </div>\n     <div class="cart-product-text">\n         <p class="cart-product-name">'+s[k][q].name+'</p> <span class="fr">×'+s[k][q].count+'</span>\n         <p class="cart-product-guige cart-guige">规格: '+s[k][q].guige+'</p>\n         <p class="cart-product-price">￥'+s[k][q].price+"</p>\n     </div>\n </div>\n </div>");v.appendChild(c)}var d=this.buildElement("div",{"class":"cart-product-footer"},'<div class="cart-product-footer-left">共<span class="cart-product-footer-num">'+s[k].length+'</span>件商品</div>\n <div class="cart-product-footer-right">\n     实付款：<span class="cart-product-footer-price">￥25111.0</span>\n </div>');u.appendChild(d);var o=this.buildElement("div",{"class":"cart-btn"},' <button class="right-btn">支付</button>\n<button class="left-btn">取消</button>');u.appendChild(o)}t.appendChild(f);$(".tab-item")[a].appendChild(t);var p=getComputedStyle($(".tab-item")[a]).height;console.log(p);$(".tab-content").css("height",p)}else{console.log("null")}}.bind(this)})},arrsort:function(a){for(let i=0;i<a.length;i++){for(let j=0;j<a.length-1;j++){if(a[j][0].ordernum<a[j+1][0].ordernum){var b=a[j];a[j]=a[j+1];a[j+1]=b}}}return a},init:function(){$(".tab-content .tab-item").css("width",this.width);$(".tab-content").css("width",this.length*parseFloat(this.width)+"px");this.clickfun();this.move(this.length,this.width);this.getlist(0)}};window.onload=function(){order.init()};window.onresize=function(){order.init()};